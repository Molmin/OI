假设我们知道所有人的获奖情况，则不妨令 **金牌的选手都取最高分，铜牌的选手都取最低分**。那么我们只需要枚举金牌最后一名和铜牌的第一名就可以确定奖牌分数线（此时分数线是 **金牌最后一名能获得的最高分** 和 **铜牌第一名能获得的最低分**）。

考虑动态规划，记 $f_{i,j,k}$ 表示前 $i$ 个人中有 $j$ 人取得金牌，$k$ 人取得银牌时获奖方案数。又因为已知分数线，所以我们可以轻松地得到状态转移方程，时间复杂度 $\Theta(n^3)$。

我们只需要 $\Theta(n^5m^2)$ 预处理，再 $\Theta(1)$ 回答询问即可。