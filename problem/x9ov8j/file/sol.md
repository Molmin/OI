考虑对于概率 $p$，令对于任意 $i\in[1,m]$，都有 $p$ 的概率将其权值重置为 $0$，求解所得集合是否为空集。进行若干次抽样，使用 **最大似然法** 估计集合大小。

设集合大小为 $x$，有 $p_1,p_2,\cdots,p_S$ 的概率重置其权值为 $0$，在 $T$ 次抽样中有 $y$ 次集合为空的概率为

$$
\prod_{i=1}^S\left(p_i^x\right)^y\left(1-p_i^x\right)^{T-y}.
$$

（$p_i^x$ 即整个集合的权值都被重置的概率。）

取上式的对数得

$$
\sum_{i=1}^S\left[xy\ln p_i+(T-y)\ln\left(1-p_i^x\right)\right].
$$

又等价于

$$
\left(\sum_{i=1}^S y\ln p_i\right)x+\sum_{i=1}^S (T-y)\ln\left(1-p_i^x\right).
$$

易知上式是一个凸函数。根据最大似然法，三分出其极值点即为集合大小 $x$ 的近似值。

在下面的代码中，使用了 $25$ 个 $p$ 值作为概率，每个 $p$ 值进行了 $10$ 次抽样测试。测试点最长用时 $7.15$ 秒，最大平均相对误差 $1.126$。