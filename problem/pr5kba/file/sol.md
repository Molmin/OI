解决了链的情况，容易想到树链剖分。每个人都分成 $\Theta(\log n)$ 的链，由于相撞只能发生在同一条链上，所以我们只需要处理每条链即可。时间复杂度 $\Theta(n+m\log n\log m)$。

实现细节：涉及精度问题，要使用 `long double`，如果还无法通过此题，就使用分数存储；计算线段交点时要注意处理两条线段平行的情况。