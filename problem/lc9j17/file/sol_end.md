记求得的操作次数 $=0$，操作次数 $\leq 1$，操作次数 $\leq 2$ 的情况数量以及情况总数分别为 $c_0,\ c_1,\ c_2,\ c_3$，那么容易知道答案为

$$
0\times c_0+1\times(c_1-c_0)+2\times(c_2-c_1)+3\times(c_3-c_2).
$$

时间复杂度 $\Theta(n)$。