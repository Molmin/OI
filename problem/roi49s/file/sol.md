容易发现连续的同号段可以合并在一起，与原问题等价。于是此时整个序列就变成正负交替的序列了。（注意 $0$ 也可以忽略掉。）

考虑最优的选法：显然最优解选择的每一段两端都必须是正数。

再考虑一种贪心做法：只选值为正数的段。

考虑以上两种选法的区别：

- 可能从贪心做法中删除了一些原来选择的段。

- 也可能将贪心做法中原来的两个相邻但不相连的段合并了。

容易证明这两种操作的影响都是使得答案减少了删除或添加的那个段的绝对值，并且总段数变少 $1$。所以我们肯定贪心地选择对绝对值最小的段进行操作，具体算法如下：

- 每次选取绝对值最小的段，将答案减去其最小值，将该段与左右两段合并并重新加入优先队列中，在从原数列中删除左右两段。

- 必须保证每次选取的数不能已经被删除。

- 若选取到最左端或最右端的段，直接删除即可。

- 重复以上操作直到段数不超过 $m$。