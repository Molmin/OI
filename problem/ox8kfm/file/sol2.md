按照“整体二分模板”部分所述，我们只需要实现维护该矩阵即可。不难想到可以使用二维树状数组。

记操作序列长度为 $Q$。则整体二分时间复杂度为 $\Theta(Q\log a)$，其中 $a$ 表示题目给定矩阵 $a$ 的取值范围大小；而树状数组是二维的，时间复杂度为 $\Theta(\log^2 n)$。又“整体二分模板”部分已证 $Q\leq n^2+q$，所以最终时间复杂度为 $\Theta\left[(n^2+q)\log a\log^2 n\right]$（实现时请注意**代码运行效率常数**）。