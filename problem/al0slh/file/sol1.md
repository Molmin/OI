首先，容易想到在 $q=0$ 时，我们只需要使用优先队列，每次取出最大的进行分割再放回去即可。

那么当 $q > 0$ 时，考虑怎么处理每次所有蚯蚓共同增加的长度 $q$。我们不可能每次都取出所有元素再一个一个地进行处理。所以我们考虑维护一个偏移量，表示整个集合要共同增加的量，每次取出时先求出原值再操作，然后减去偏移量放回即可。

时间复杂度 $\Theta(m\log m)$。