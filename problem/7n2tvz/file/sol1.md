考虑后四种询问。

把整个项链当成一条链来做，在其上建线段树，维护不同颜色的段数。合并时还需要用到区间两端的颜色，所以对每个区间还需要维护区间两端颜色。

对于整个项链的查询，只需当成区间 $[1,n]$ 来做，在特判两端是否为同种颜色即可。