**本题细节较多，码量较大。** 实现细节：

- 查询区间颜色段数量时，需要注意输入的区间两端是按**顺时针方向**的，而不是从编号小的到编号大的。若编号大的在前，只需将区间拆为 $[l,n]$ 和 $[1,r]$ 两个部分计算，再合并即可。

- 查询整个项链的颜色段数量时，要注意整个项链为同一种颜色的情况。（只需计算后答案与 $1$ 取 $\max$ 即可。）